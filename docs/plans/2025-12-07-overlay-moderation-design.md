# Overlay Moderation Feature Design

## Overview

–§–∏—á–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏–∑ —á–∞—Ç–∞ –≤ OBS –æ–≤–µ—Ä–ª–µ–µ –≤–æ –≤—Ä–µ–º—è —Å—Ç—Ä–∏–º–∞. –°—Ç—Ä–∏–º–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ –∞–¥–º–∏–Ω–∫–µ, –æ–Ω –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –æ–≤–µ—Ä–ª–µ–µ —Å typewriter –∞–Ω–∏–º–∞—Ü–∏–µ–π, –∑—Ä–∏—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –Ω–∞ –∫–∞–∫–æ–π –≤–æ–ø—Ä–æ—Å –æ—Ç–≤–µ—á–∞–µ—Ç —Å—Ç—Ä–∏–º–µ—Ä.

## User Flow

1. –°—Ç—Ä–∏–º–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/transmissions` –∏ `/obs` (–≤ OBS Browser Source)
2. –í–æ –≤—Ä–µ–º—è —Å—Ç—Ä–∏–º–∞ –≤–∏–¥–∏—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ —á–∞—Ç–µ
3. –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ø–æ–∫–∞–∑–∞—Ç—å –≤ –æ–≤–µ—Ä–ª–µ–µ" —Ä—è–¥–æ–º —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
4. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ OBS —Å typewriter –∞–Ω–∏–º–∞—Ü–∏–µ–π
5. –°—Ç—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –≥–æ–ª–æ—Å–æ–º
6. –ù–∞–∂–∏–º–∞–µ—Ç "—É–±—Ä–∞—Ç—å –∏–∑ –æ–≤–µ—Ä–ª–µ—è"
7. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏—Å—á–µ–∑–∞–µ—Ç

## Architecture

### API Endpoint: `/api/overlay`

```typescript
// app/api/overlay/route.ts

interface OverlayMessage {
  id: string
  author: string
  authorPhoto?: string
  message: string
  timestamp: number
}

let currentOverlay: OverlayMessage | null = null

// GET ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
// POST ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
// DELETE ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –æ–≤–µ—Ä–ª–µ–π
```

### Data Flow

```
[/transmissions] --POST--> [/api/overlay] <--GET(polling)-- [/obs]
                 --DELETE->
```

–°–æ—Å—Ç–æ—è–Ω–∏–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –º–æ–¥—É–ª—è). –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

## UI Changes

### /transmissions

**–ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ (–Ω–∞ –∫–∞–∂–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏):**
- –ò–∫–æ–Ω–∫–∞ "üì∫" —Å–ø—Ä–∞–≤–∞ –æ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü—Ä–∏ –∫–ª–∏–∫–µ: POST `/api/overlay` —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ê–∫—Ç–∏–≤–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤—ã–¥–µ–ª—è–µ—Ç—Å—è —Ä–∞–º–∫–æ–π/—Ü–≤–µ—Ç–æ–º

**–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–≤–µ—Ä–ª–µ–µ–º (–≤–≤–µ—Ä—Ö—É —á–∞—Ç–∞):**
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞: "–í –æ–≤–µ—Ä–ª–µ–µ: {–∞–≤—Ç–æ—Ä}" –∏–ª–∏ "–û–≤–µ—Ä–ª–µ–π –ø—É—Å—Ç"
- –ö–Ω–æ–ø–∫–∞ "–£–±—Ä–∞—Ç—å –∏–∑ –æ–≤–µ—Ä–ª–µ—è" (DELETE `/api/overlay`)

### /obs

**–ë–ª–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:**
- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫, –Ω–µ –º–µ—à–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–º—É —á–∞—Ç—É
- –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –∫–æ–≥–¥–∞ –ø—É—Å—Ç
- Polling: GET `/api/overlay` –∫–∞–∂–¥—ã–µ 1.5 —Å–µ–∫—É–Ω–¥—ã

**–ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è:**
1. Fade-in –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (~0.3s)
2. –ò–º—è –∞–≤—Ç–æ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
3. –¢–µ–∫—Å—Ç –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ (~50ms –Ω–∞ —Å–∏–º–≤–æ–ª)

**–ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è:**
- Fade-out (~0.3s)

**–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è:**
- –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω
- –ê–≤–∞—Ç–∞—Ä –∞–≤—Ç–æ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ò–º—è –∞–≤—Ç–æ—Ä–∞ –≤—ã–¥–µ–ª–µ–Ω–æ —Ü–≤–µ—Ç–æ–º
- –ö—Ä—É–ø–Ω—ã–π —á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç

## Implementation Tasks

1. –°–æ–∑–¥–∞—Ç—å `/api/overlay/route.ts` —Å GET/POST/DELETE
2. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤—ã–±–æ—Ä–∞ –∫ —Å–æ–æ–±—â–µ–Ω–∏—è–º –≤ `/transmissions`
3. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–≤–µ—Ä–ª–µ–µ–º –≤ `/transmissions`
4. –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ–≤–µ—Ä–ª–µ—è —Å typewriter –∞–Ω–∏–º–∞—Ü–∏–µ–π
5. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π –≤ `/obs` —Å polling

## Technical Notes

- Polling –∏–Ω—Ç–µ—Ä–≤–∞–ª 1.5s ‚Äî –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å—é –∏ –Ω–∞–≥—Ä—É–∑–∫–æ–π
- Typewriter —Å–∫–æ—Ä–æ—Å—Ç—å ~50ms/—Å–∏–º–≤–æ–ª ‚Äî —á–∏—Ç–∞–µ–º–æ, –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ (–ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è MVP)
